@startuml
!theme vibrant

title Sequence Diagram: Admin Login with JWT

actor Admin
participant Browser
participant "API Gateway" as Gateway
participant "Auth Service" as AuthService
database "UserDB"

activate Browser
Admin -> Browser : Enters details in /admin/login
Browser ->> Gateway : POST /api/users/login\n(email, password)
activate Gateway

Gateway ->> AuthService : login(email, password)
activate AuthService

AuthService -> AuthService : Verify role === 'Admin'
AuthService ->> UserDB : login(email, password)
activate UserDB
UserDB -->> AuthService : User Document (incl. email, name, role)
deactivate UserDB

alt Credentials & Role Valid

    AuthService -> AuthService : Generate & sign JWT\n(payload: {userId, email, name, role})
    AuthService -->> Gateway : 200 OK { jwt: "..." }
else Credentials or Role Invalid
    AuthService -->> Gateway : 401 Unauthorized
end

deactivate AuthService

Gateway -->> Browser : Response (200 OK or 401)
deactivate Gateway

alt Login Successful
    Browser -> Browser : Store JWT (cookieStorage)
    Browser -> Admin : Redirect to /admin/dashboard
else Login Failed
    Browser -> Admin : Display "Invalid credentials" error
end


@enduml